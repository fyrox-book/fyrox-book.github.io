<!DOCTYPE HTML>
<html lang="en" class="navy sidebar-visible" dir="ltr">
    <head>
        <!-- Book generated using mdBook -->
        <meta charset="UTF-8">
        <title>ABSM Editor - Fyrox Book</title>


        <!-- Custom HTML head -->
        <!-- Google tag (gtag.js) -->
        <script async src="https://www.googletagmanager.com/gtag/js?id=G-ETGWNBR03Y"></script>
        <script>
          window.dataLayer = window.dataLayer || [];
          function gtag(){dataLayer.push(arguments);}
          gtag('js', new Date());
        
          gtag('config', 'G-ETGWNBR03Y');
        </script>

        <meta name="description" content="">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="theme-color" content="#ffffff">

        <link rel="icon" href="../favicon.svg">
        <link rel="shortcut icon" href="../favicon.png">
        <link rel="stylesheet" href="../css/variables.css">
        <link rel="stylesheet" href="../css/general.css">
        <link rel="stylesheet" href="../css/chrome.css">
        <link rel="stylesheet" href="../css/print.css" media="print">

        <!-- Fonts -->
        <link rel="stylesheet" href="../FontAwesome/css/font-awesome.css">
        <link rel="stylesheet" href="../fonts/fonts.css">

        <!-- Highlight.js Stylesheets -->
        <link rel="stylesheet" id="highlight-css" href="../highlight.css">
        <link rel="stylesheet" id="tomorrow-night-css" href="../tomorrow-night.css">
        <link rel="stylesheet" id="ayu-highlight-css" href="../ayu-highlight.css">

        <!-- Custom theme stylesheets -->

        <!-- MathJax -->
        <script async src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>

        <!-- Provide site root and default themes to javascript -->
        <script>
            const path_to_root = "../";
            const default_light_theme = "navy";
            const default_dark_theme = "navy";
            window.path_to_searchindex_js = "../searchindex.js";
        </script>
        <!-- Start loading toc.js asap -->
        <script src="../toc.js"></script>
    </head>
    <body>
    <div id="mdbook-help-container">
        <div id="mdbook-help-popup">
            <h2 class="mdbook-help-title">Keyboard shortcuts</h2>
            <div>
                <p>Press <kbd>←</kbd> or <kbd>→</kbd> to navigate between chapters</p>
                <p>Press <kbd>S</kbd> or <kbd>/</kbd> to search in the book</p>
                <p>Press <kbd>?</kbd> to show this help</p>
                <p>Press <kbd>Esc</kbd> to hide this help</p>
            </div>
        </div>
    </div>
    <div id="body-container">
        <!-- Work around some values being stored in localStorage wrapped in quotes -->
        <script>
            try {
                let theme = localStorage.getItem('mdbook-theme');
                let sidebar = localStorage.getItem('mdbook-sidebar');

                if (theme.startsWith('"') && theme.endsWith('"')) {
                    localStorage.setItem('mdbook-theme', theme.slice(1, theme.length - 1));
                }

                if (sidebar.startsWith('"') && sidebar.endsWith('"')) {
                    localStorage.setItem('mdbook-sidebar', sidebar.slice(1, sidebar.length - 1));
                }
            } catch (e) { }
        </script>

        <!-- Set the theme before any content is loaded, prevents flash -->
        <script>
            const default_theme = window.matchMedia("(prefers-color-scheme: dark)").matches ? default_dark_theme : default_light_theme;
            let theme;
            try { theme = localStorage.getItem('mdbook-theme'); } catch(e) { }
            if (theme === null || theme === undefined) { theme = default_theme; }
            const html = document.documentElement;
            html.classList.remove('navy')
            html.classList.add(theme);
            html.classList.add("js");
        </script>

        <input type="checkbox" id="sidebar-toggle-anchor" class="hidden">

        <!-- Hide / unhide sidebar before it is displayed -->
        <script>
            let sidebar = null;
            const sidebar_toggle = document.getElementById("sidebar-toggle-anchor");
            if (document.body.clientWidth >= 1080) {
                try { sidebar = localStorage.getItem('mdbook-sidebar'); } catch(e) { }
                sidebar = sidebar || 'visible';
            } else {
                sidebar = 'hidden';
                sidebar_toggle.checked = false;
            }
            if (sidebar === 'visible') {
                sidebar_toggle.checked = true;
            } else {
                html.classList.remove('sidebar-visible');
            }
        </script>

        <nav id="sidebar" class="sidebar" aria-label="Table of contents">
            <!-- populated by js -->
            <mdbook-sidebar-scrollbox class="sidebar-scrollbox"></mdbook-sidebar-scrollbox>
            <noscript>
                <iframe class="sidebar-iframe-outer" src="../toc.html"></iframe>
            </noscript>
            <div id="sidebar-resize-handle" class="sidebar-resize-handle">
                <div class="sidebar-resize-indicator"></div>
            </div>
        </nav>

        <div id="page-wrapper" class="page-wrapper">

            <div class="page">
                <div id="menu-bar-hover-placeholder"></div>
                <div id="menu-bar" class="menu-bar sticky">
                    <div class="left-buttons">
                        <label id="sidebar-toggle" class="icon-button" for="sidebar-toggle-anchor" title="Toggle Table of Contents" aria-label="Toggle Table of Contents" aria-controls="sidebar">
                            <i class="fa fa-bars"></i>
                        </label>
                        <button id="theme-toggle" class="icon-button" type="button" title="Change theme" aria-label="Change theme" aria-haspopup="true" aria-expanded="false" aria-controls="theme-list">
                            <i class="fa fa-paint-brush"></i>
                        </button>
                        <ul id="theme-list" class="theme-popup" aria-label="Themes" role="menu">
                            <li role="none"><button role="menuitem" class="theme" id="default_theme">Auto</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="light">Light</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="rust">Rust</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="coal">Coal</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="navy">Navy</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="ayu">Ayu</button></li>
                        </ul>
                        <button id="search-toggle" class="icon-button" type="button" title="Search (`/`)" aria-label="Toggle Searchbar" aria-expanded="false" aria-keyshortcuts="/ s" aria-controls="searchbar">
                            <i class="fa fa-search"></i>
                        </button>
                    </div>

                    <h1 class="menu-title">Fyrox Book</h1>

                    <div class="right-buttons">
                        <a href="../print.html" title="Print this book" aria-label="Print this book">
                            <i id="print-button" class="fa fa-print"></i>
                        </a>
                        <a href="https://github.com/fyrox-book/fyrox-book.github.io/tree/main" title="Git repository" aria-label="Git repository">
                            <i id="git-repository-button" class="fa fa-github"></i>
                        </a>
                        <a href="https://github.com/fyrox-book/fyrox-book.github.io/edit/main/src/animation/absm_editor.md" title="Suggest an edit" aria-label="Suggest an edit" rel="edit">
                            <i id="git-edit-button" class="fa fa-edit"></i>
                        </a>

                    </div>
                </div>

                <div id="search-wrapper" class="hidden">
                    <form id="searchbar-outer" class="searchbar-outer">
                        <div class="search-wrapper">
                            <input type="search" id="searchbar" name="searchbar" placeholder="Search this book ..." aria-controls="searchresults-outer" aria-describedby="searchresults-header">
                            <div class="spinner-wrapper">
                                <i class="fa fa-spinner fa-spin"></i>
                            </div>
                        </div>
                    </form>
                    <div id="searchresults-outer" class="searchresults-outer hidden">
                        <div id="searchresults-header" class="searchresults-header"></div>
                        <ul id="searchresults">
                        </ul>
                    </div>
                </div>

                <!-- Apply ARIA attributes after the sidebar and the sidebar toggle button are added to the DOM -->
                <script>
                    document.getElementById('sidebar-toggle').setAttribute('aria-expanded', sidebar === 'visible');
                    document.getElementById('sidebar').setAttribute('aria-hidden', sidebar !== 'visible');
                    Array.from(document.querySelectorAll('#sidebar a')).forEach(function(link) {
                        link.setAttribute('tabIndex', sidebar === 'visible' ? 0 : -1);
                    });
                </script>

                <div id="content" class="content">
                    <main>
                        <h1 id="animation-blending-state-machine-absm-editor"><a class="header" href="#animation-blending-state-machine-absm-editor">Animation Blending State Machine (ABSM) Editor</a></h1>
<p>While it is possible to create and manage animation blending and state manually from code, it quickly becomes too
annoying and hardly manageable. To help you create and manage blending machines in easy way, the engine offers
an ABSM Editor tool. This chapter is an overview of the editor, it is quite complex, but the guide should help you
to figure out which part is made for what. Next chapter will help you to create your first animation blending state
machine.</p>
<p><img src="./absm.png" alt="absm editor" /></p>
<p>The editor has four main parts (panels):</p>
<ol>
<li><code>Toolbar</code> - contains a set of tools to edit animation layers and enable/disable preview mode. See <a href="#toolbar">Toolbar</a>
section for more info.</li>
<li><code>Parameters</code> - allows you to edit various variables that are responsible for transitions, weight parameters for
blending, etc. See <a href="./absm_parameters.png">Parameters</a> section for more info.</li>
<li><code>State Graph</code> - allows you to create, delete, edit states and transition between them. See <a href="#state-graph">State Graph</a>
section for more info.</li>
<li><code>State Viewer</code> - allows you to edit pose source for a state. Pose source can be represented either by a single
node that plays an animation, or a series of play animation nodes connected to blending nodes (which can be connected
to other blending nodes, etc.). See <a href="#state-viewer">State Viewer</a> section for more info.</li>
</ol>
<p>The editor can be opened in two ways - using <code>Utils -&gt; ABSM Editor</code> or by selecting an animation blending state machine
node and clicking <code>Open ABSM Editor...</code> button:</p>
<p><img src="./absm_open1.png" alt="open1" /></p>
<p><img src="./absm_open2.png" alt="open1" /></p>
<p>In both ways you still need to select an an animation blending state machine node for editing.</p>
<h2 id="toolbar"><a class="header" href="#toolbar">Toolbar</a></h2>
<p><img src="./absm_toolbar.png" alt="toolbar" /></p>
<ol>
<li><code>Preview Switch</code> - enables or disables preview mode for the ABSM. See <a href="#preview-mode">Preview Mode</a> section for more
info.</li>
<li><code>Layer Name</code> - name of the selected layer. Type a new name here to rename currently selected layer (hit enter or just
click elsewhere to rename).</li>
<li><code>Add Layer</code> - adds a new layer with the name in the <code>Layer Name</code> text box to the ABSM. ABSM can have multiple layers
with the same name, but it strongly advised to set unique names here.</li>
<li><code>Remove Current Layer</code> - removes currently selected layer. You can delete all layers, but in this case your ABSM won't
have any effect.</li>
<li><code>Layer Selector</code> - allows you to select a layer for editing, default selection is none.</li>
<li><code>Layer Mask</code> - opens a <code>Layer Mask Editor</code> and helps you to edit the layer mask of the current layer. See
<a href="#layer-mask">Layer Mask</a> section for more info.</li>
</ol>
<h2 id="parameters"><a class="header" href="#parameters">Parameters</a></h2>
<p>Parameter is a named and typed variable that provides the animation system with some data required for it to work. There
are only three type of parameters:</p>
<ul>
<li><code>Rule</code> - boolean value that used as a trigger for transitions. When transition is using some rule, it checks the value
of the parameter and if it is <code>true</code> transition starts.</li>
<li><code>Weight</code> - real number (<code>f32</code>) that is used a weight when you're blending multiple animations into one.</li>
<li><code>Index</code> - natural number (<code>i32</code>) that is used as an animation selector.</li>
</ul>
<p><img src="./absm_parameters.png" alt="parameters" /></p>
<ol>
<li><code>Add Parameters</code> - adds a new parameter to the parameters' container.</li>
<li><code>Remove a Parameter</code> - removes selected parameter from the parameters' container.</li>
<li><code>Parameter Name</code> - allows you to set a parameter name.</li>
<li><code>Parameter Type</code> - allows you to select the type of the parameter.</li>
<li><code>Parameter Value</code> - allows you to set parameter value.</li>
</ol>
<h2 id="state-graph"><a class="header" href="#state-graph">State Graph</a></h2>
<p>State Graph allows you to create states and transitions between them.</p>
<p><img src="./absm_state_graph.png" alt="state graph" /></p>
<ol>
<li><code>State</code> - state is final animation for a set of scene nodes, only one state can be active at a time.</li>
<li><code>Transition</code> - is an <em>ordered</em> connection between two states, it defines how much time it needed to perform
blending of two states.</li>
<li><code>Root State</code> - is an entry state of the current layer.</li>
</ol>
<h3 id="state-context-menu"><a class="header" href="#state-context-menu">State Context Menu</a></h3>
<p><img src="./absm_state_context_menu.png" alt="state context menu" /></p>
<ul>
<li><code>Create Transition</code> - starts transition creation from the current state to some other.</li>
<li><code>Remove</code> - removes the state.</li>
<li><code>Set As Entry State</code> - marks the state as an entry state (this state will be active at beginning).</li>
</ul>
<h3 id="transition-context-menu"><a class="header" href="#transition-context-menu">Transition Context Menu</a></h3>
<p><img src="./absm_transition_context_menu.png" alt="transition context menu" /></p>
<ul>
<li><code>Remove Transition</code> - removes selected transition.</li>
</ul>
<h3 id="state-properties"><a class="header" href="#state-properties">State Properties</a></h3>
<p>Select a <code>State</code> node to edit the following properties:</p>
<p><img src="./absm_state_properties.png" alt="state properties" /></p>
<ul>
<li><code>Position</code> - is a location of the state on the canvas.</li>
<li><code>Name</code> - name of the state.</li>
<li><code>Root</code> - handle of the backing animation node inside the state.</li>
</ul>
<h3 id="transition-properties"><a class="header" href="#transition-properties">Transition Properties</a></h3>
<p>Select a <code>Transition</code> node to edit the following properties:</p>
<p><img src="./absm_transition_properties.png" alt="transition properties" /></p>
<ul>
<li><code>Name</code> - name of the state.</li>
<li><code>Transition Time</code> - amount of time for blending between two states (in seconds).</li>
<li><code>Elapsed Time</code> - starting amount of blending time.</li>
<li><code>Source</code> - handle of a source state.</li>
<li><code>Desc</code> - handle of a destination state.</li>
<li><code>Rule</code> - a name of <code>Rule</code> type parameter that defines whether the transition can be activated or not.</li>
<li><code>Invert Rule</code> - defines whether to invert the value of <code>Rule</code> or not.</li>
<li><code>Blend Factor</code> - defines a percentage (in <code>0..1</code> range) of how much transition was active.</li>
</ul>
<h2 id="state-viewer"><a class="header" href="#state-viewer">State Viewer</a></h2>
<p>State Viewer allows you to edit contents of states. You can create animation blending chains of any complexity, the
simplest content of a state is just a single <code>Play Animation</code> node. Currently, the engine supports just three animation
blending nodes:</p>
<ul>
<li><code>Play Animation</code> - takes animation pose directly from specified animation, does nothing to it.</li>
<li><code>Blend Animations</code> - takes multiple animation poses from respective animations and blends them together with
respective blend weights.</li>
<li><code>Blend Animations By Index</code> - takes multiple animation poses from respective animations and switches between them
with "smooth" transition using an index parameter.</li>
</ul>
<p><img src="./absm_state_viewer.png" alt="state viewer" /></p>
<ol>
<li><code>Node</code> - is a source of animation for blending.</li>
<li><code>Connection</code> - defines how nodes are connected to each other. To create a new connection, click on a small dot on a
node, hold the button and start dragging to a dot on some other node.</li>
<li><code>Root Node</code> - root node is marked green; root node is a final source of animation for the parent state.</li>
</ol>
<h3 id="play-animation-properties"><a class="header" href="#play-animation-properties"><code>Play Animation</code> Properties</a></h3>
<p>Select a <code>Play Animation</code> node to edit the following properties:</p>
<p><img src="./absm_play_animation_properties.png" alt="play animation properties" /></p>
<ul>
<li><code>Position</code> - is a location of the node on the canvas.</li>
<li><code>Animation</code> - an animation to fetch the pose from.</li>
</ul>
<h3 id="blend-animations-properties"><a class="header" href="#blend-animations-properties"><code>Blend Animations</code> Properties</a></h3>
<p>Select a <code>Blend Animations</code> node to edit the following properties:</p>
<p><img src="./absm_blend_animations_properties.png" alt="blend animations properties" /></p>
<ul>
<li><code>Position</code> - is a location of the node on the canvas.</li>
<li><code>Pose Sources</code> - a set of input poses. To add a pose either click on <code>+</code> or <code>+Input</code> on the node itself. Don't forget
to connect some nodes to the new input poses.
<ul>
<li><code>Weight</code> - a weight of the pose; could be either a constant value or some parameter.</li>
</ul>
</li>
</ul>
<h3 id="blend-animations-by-index-properties"><a class="header" href="#blend-animations-by-index-properties"><code>Blend Animations By Index</code> Properties</a></h3>
<p>Select a <code>Blend Animations By Index</code> node to edit the following properties:</p>
<p><img src="./absm_blend_animations_by_index_properties.png" alt="blend animations by index properties" /></p>
<ul>
<li><code>Position</code> - is a location of the node on the canvas.</li>
<li><code>Index Parameter</code> - a name of an indexing parameter (must be <code>Index</code> type).</li>
<li><code>Inputs</code> - a set of input poses. To add a pose either click on <code>+</code> or <code>+Input</code> on the node itself. Don't forget to
connect some nodes to the new input poses.
<ul>
<li><code>Blend Time</code> - defines how much time is needed to transition to the pose.</li>
</ul>
</li>
</ul>
<h3 id="connection-context-menu"><a class="header" href="#connection-context-menu">Connection Context Menu</a></h3>
<p>Every connection has a context menu that can be shown by a right-click on a connection.</p>
<p><img src="./absm_connection_context_menu.png" alt="connection context menu" /></p>
<ul>
<li><code>Remove Connection</code> - removes the connection between parent nodes.</li>
</ul>
<h3 id="node-context-menu"><a class="header" href="#node-context-menu">Node Context Menu</a></h3>
<p>Every node has a context menu that can be shown by a right-click on a connection.</p>
<p><img src="./absm_node_context_menu.png" alt="node context menu" /></p>
<ul>
<li><code>Set As Root</code> - sets the node as the final pose source of the parent state.</li>
<li><code>Remove</code> - removes the node from the state.</li>
</ul>
<h2 id="layer-mask"><a class="header" href="#layer-mask">Layer Mask</a></h2>
<p><img src="./absm_layer_mask.png" alt="layer mask" /></p>
<p>Layer mask editor allows you to select which nodes <strong>won't</strong> be animated by the current animation layer. Selected nodes
are marked with dark color. To select multiple nodes at once, hold <code>Ctrl</code> and click on items. The text box at the top
of the window allows you to search for a particular scene node. To save edited layer mask click <code>OK</code>.</p>
<h2 id="preview-mode"><a class="header" href="#preview-mode">Preview Mode</a></h2>
<p>Preview mode turns on the animation blending state machine and its animation player and allows you to see the result
of the work of the machine. Any significant changes in the scene automatically disables the preview mode and any
changes done by the machine is discarded. While the preview mode is active, you can freely change the values of the
parameters to see how the machine will react to this. This helps you to debug your state machine, it is especially
useful for complex state machines with lots of layers. Here's how the preview mode works:</p>
<p><img src="./absm.gif" alt="absm" /></p>

                    </main>

                    <nav class="nav-wrapper" aria-label="Page navigation">
                        <!-- Mobile navigation buttons -->
                            <a rel="prev" href="../animation/blending.html" class="mobile-nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                                <i class="fa fa-angle-left"></i>
                            </a>

                            <a rel="next prefetch" href="../animation/signal.html" class="mobile-nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                                <i class="fa fa-angle-right"></i>
                            </a>

                        <div style="clear: both"></div>
                    </nav>
                </div>
            </div>

            <nav class="nav-wide-wrapper" aria-label="Page navigation">
                    <a rel="prev" href="../animation/blending.html" class="nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                        <i class="fa fa-angle-left"></i>
                    </a>

                    <a rel="next prefetch" href="../animation/signal.html" class="nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                        <i class="fa fa-angle-right"></i>
                    </a>
            </nav>

        </div>



        <script>
            window.playground_line_numbers = true;
        </script>

        <script>
            window.playground_copyable = true;
        </script>

        <script src="../ace.js"></script>
        <script src="../mode-rust.js"></script>
        <script src="../editor.js"></script>
        <script src="../theme-dawn.js"></script>
        <script src="../theme-tomorrow_night.js"></script>

        <script src="../elasticlunr.min.js"></script>
        <script src="../mark.min.js"></script>
        <script src="../searcher.js"></script>

        <script src="../clipboard.min.js"></script>
        <script src="../highlight.js"></script>
        <script src="../book.js"></script>

        <!-- Custom JS scripts -->



    </div>
    </body>
</html>
